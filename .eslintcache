[{"C:\\Users\\user\\work\\react-websocket-chatroom\\src\\index.js":"1","C:\\Users\\user\\work\\react-websocket-chatroom\\src\\App.js":"2","C:\\Users\\user\\work\\react-websocket-chatroom\\src\\reportWebVitals.js":"3"},{"size":517,"mtime":1612156171745,"results":"4","hashOfConfig":"5"},{"size":3016,"mtime":1620207275039,"results":"6","hashOfConfig":"5"},{"size":375,"mtime":1612156171746,"results":"7","hashOfConfig":"5"},{"filePath":"8","messages":"9","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"10"},"lb4spf",{"filePath":"11","messages":"12","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"13"},{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"10"},"C:\\Users\\user\\work\\react-websocket-chatroom\\src\\index.js",[],["16","17"],"C:\\Users\\user\\work\\react-websocket-chatroom\\src\\App.js",["18","19","20","21","22","23","24","25"],"import logo from './logo.svg';\r\nimport './App.css';\r\nimport React, { useState, useEffect } from 'react'\r\nimport ReactDom from 'react-dom'\r\n// import webSocket from 'socket.io-client'\r\n\r\n\r\nconst App = () => {\r\n  const [ws,setWs] = useState(null)\r\n  const [msg,setMsg] = useState(\"\")\r\n  // ws://127.0.0.1:9527/ws\r\n  // ws://127.0.0.1:9527/ws\r\n  // 正式：wss://chainss-dex-node.azurewebsites.net\r\n\r\n  // const [wsAddress,setWsAddress] = useState(\"ws://13.88.218.45:9527/ws/market-summary\")\r\n  // const [wsAddress,setWsAddress] = useState(\"ws://127.0.0.1:9527/ws/market-summary\")\r\n  // const [wsAddress,setWsAddress] = useState(\"ws://127.0.0.1:9527/ws/markets-summary\")\r\n  // const [wsAddress,setWsAddress] = useState(\"ws://127.0.0.1:9527/ws/market-summary\")\r\n  // const [wsAddress,setWsAddress] = useState(\"wss://13.88.218.45/ws/market-summary\")\r\n  const [wsAddress,setWsAddress] = useState(\"ws://127.0.0.1/ws/subscribe\") \r\n\r\n  const [wsRoute,setWsRoute] = useState(\"\")\r\n\r\n  // 連線到WebSocket\r\n  const connectWebSocket = () => {\r\n    if(!ws){\r\n      if(wsAddress != \"\"){\r\n        var wsTarget = wsAddress\r\n        if (wsRoute != \"\"){\r\n          wsTarget += \"/\"+wsRoute\r\n        }\r\n        setWs(new WebSocket(wsTarget))\r\n      }\r\n    }else{\r\n      console.log(\"已經連線，所以不動作\")\r\n    }\r\n  }\r\n\r\n  const desConnectWebSocket = ()=>{\r\n    if(ws){\r\n      ws.onclose = ()=>{\r\n        setWs(null)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 初始化WebSocket的動作\r\n  const initWebSocket = () => {\r\n    if(ws){\r\n\r\n      // 連線成功\r\n      ws.onopen = ()=>{\r\n        console.log(\"連線成功\",ws)\r\n        ws.send('{\"token\":\"胖虎\",\"content\":\"小夫，我要進來囉!\"}')\r\n      }\r\n\r\n      //連線關閉\r\n      \r\n      ws.onclose = ()=>{\r\n        setWs(null)\r\n        ws.send(\"小夫進不來!\")\r\n        console.log(\"關閉連線\",ws)\r\n      }\r\n\r\n      // 在接到Server發進來的訊息\r\n      ws.onmessage = (event) => {\r\n        console.log(\"來自Server:\",event)\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  //向Server傳東西\r\n  const sendMessage = () => {\r\n    if(ws && msg){\r\n      ws.send(msg)\r\n    }\r\n  }\r\n  \r\n\r\n  useEffect(()=>{\r\n    if(ws){\r\n\r\n        console.log(\"WebSocket連線中...\")\r\n\r\n        \r\n\r\n        // 初始化websocket對應的動作\r\n        initWebSocket()\r\n\r\n    }\r\n  },[ws])\r\n\r\n  const inputMessage = (event)=>{\r\n    setMsg(event.target.value)\r\n  }\r\n\r\n  const inputRoute = (event)=>{\r\n    setWsRoute(event.target.value)\r\n  }\r\n\r\n  // 最終Render\r\n  return (\r\n    <div>\r\n      <div>\r\n        <span>市場輸入</span>\r\n        <input type=\"text\" onChange={inputRoute}/>\r\n        <input type='button' value='打開連線' onClick={connectWebSocket} />\r\n        <input type='button' value='中斷連線' onClick={desConnectWebSocket} />\r\n      </div>\r\n      {/* <div>\r\n          <input type=\"text\" onChange={inputMessage}></input>\r\n          \r\n          \r\n          <input type='button' value='送出訊息' onClick={sendMessage} />\r\n      </div> */}\r\n    </div>\r\n  )\r\n}\r\nexport default App;\r\n","C:\\Users\\user\\work\\react-websocket-chatroom\\src\\reportWebVitals.js",[],{"ruleId":"26","replacedBy":"27"},{"ruleId":"28","replacedBy":"29"},{"ruleId":"30","severity":1,"message":"31","line":1,"column":8,"nodeType":"32","messageId":"33","endLine":1,"endColumn":12},{"ruleId":"30","severity":1,"message":"34","line":4,"column":8,"nodeType":"32","messageId":"33","endLine":4,"endColumn":16},{"ruleId":"30","severity":1,"message":"35","line":20,"column":20,"nodeType":"32","messageId":"33","endLine":20,"endColumn":32},{"ruleId":"36","severity":1,"message":"37","line":27,"column":20,"nodeType":"38","messageId":"39","endLine":27,"endColumn":22},{"ruleId":"36","severity":1,"message":"37","line":29,"column":21,"nodeType":"38","messageId":"39","endLine":29,"endColumn":23},{"ruleId":"30","severity":1,"message":"40","line":74,"column":9,"nodeType":"32","messageId":"33","endLine":74,"endColumn":20},{"ruleId":"41","severity":1,"message":"42","line":92,"column":5,"nodeType":"43","endLine":92,"endColumn":9,"suggestions":"44"},{"ruleId":"30","severity":1,"message":"45","line":94,"column":9,"nodeType":"32","messageId":"33","endLine":94,"endColumn":21},"no-native-reassign",["46"],"no-negated-in-lhs",["47"],"no-unused-vars","'logo' is defined but never used.","Identifier","unusedVar","'ReactDom' is defined but never used.","'setWsAddress' is assigned a value but never used.","eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","'sendMessage' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'initWebSocket'. Either include it or remove the dependency array.","ArrayExpression",["48"],"'inputMessage' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"49","fix":"50"},"Update the dependencies array to be: [initWebSocket, ws]",{"range":"51","text":"52"},[2137,2141],"[initWebSocket, ws]"]